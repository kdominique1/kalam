import{ba as X,bh as ne,bi as I,aI as $,bb as s,bk as le,aT as e,aV as J,b0 as re,bs as A,bo as ie,bp as se,bq as oe,bw as B,cW as ce,bt as V,bz as Y,bA as j,bB as C,cX as E,bF as U,bl as de,br as me,b as N,bU as ue,cS as pe,bd as he,cz as ge,cA as be,cB as fe,cb as T,bj as we,bn as ve,bf as ye,be as xe}from"./vendor.9dfca3cc.js";import{u as Se,M as K,v as De,w as Oe,x as Ce,y as Ae,z as G,A as ke,B as R}from"./index.ad695817.js";import{a as F}from"./vendor_axios.5abceb0c.js";import"./vendor_core_js_pure.26d1b0db.js";import"./vendor_react_epic_spinners.bbaea7d4.js";import"./vendor_mui_datatables.3afb61c8.js";import"./vendor_lodash.872a697f.js";import"./vendor_react_slick.b9cbcc15.js";import"./vendor_react_easy_edit.1ec3282f.js";import"./vendor_react_player.58c4554f.js";const L="https://join.navgurukul.org/api/",q=[{value:"EnglishInterview",label:"English Interview Pending (2nd Round)"},{value:"AlgebraInterview",label:"Algebra Interview Pending (3rd Round)"},{value:"CultureFitInterview",label:"Culture Fit Interview Pending (4th Round)"}],_e=X(g=>({container:{display:"flex",flexWrap:"wrap",flexDirection:"column",maxWidth:400},root:{maxWidth:450,margin:"auto",marginTop:"20px"},addIcon:{position:"absolute",marginLeft:"60%",top:"9px"},text:{marginBottom:g.spacing(1)},btn:{}})),H=({updateOwners:g,isEdit:o,disabled:f,ownerData:y,ownerId:d})=>{const b=_e(),{enqueueSnackbar:u}=ne(),{users:S}=I(a=>a.owners),[D,l]=$.useState(!1),[p,t]=$.useState({name:null,id:d!=null?d:null,availablity:"",stage:[],limit:0,gender:""}),i=async a=>{var w,v;const r=(w=(await F.get(`${L}owner/${a}`)).data)==null?void 0:w.data[0];t({name:r.user.mail_id,gender:(v=r.gender)!=null?v:"",availablity:r.available,stage:r.type,limit:r.max_limit,id:r.id})},h=()=>{const{name:a,gender:n,id:r,availablity:w,stage:v,limit:O}=p;if(y.some(P=>P.user.mail_id===a)){u(`${a} exists in owner dashboard.`,{variant:"error"});return}a&&r&&n&&v&&w!==""&&O>0?F.post(`${L}owner`,{user_id:r,available:w==="Yes",max_limit:O?parseInt(O,10):void 0,type:v,gender:parseInt(n,10)}).then(P=>{u("Owner Successfull created !",{variant:"success"}),l(!1),g(P.data.data[0],!1)}):u("Please fill all fields",{variant:"error"})},m=async()=>{l(!0),o&&await i(d)},c=(a,n)=>{l(!1),!n&&t({name:null,id:d!=null?d:null,availablity:"",stage:[],limit:0,gender:""})},x=()=>{const{name:a,gender:n,id:r,availablity:w,stage:v,limit:O}=p;a&&r&&n&&v&&w!==""&&O>0?F.put(`${L}owner/${r}`,{available:w,max_limit:parseInt(O,10),type:v,gender:parseInt(n,10)}).then(_=>{u("Owner Successfull updated!",{variant:"success"}),c(),g(_.data.data[0],!0)}).catch(_=>{console.error(_.message),u("Interviews limit  should not be 10",{variant:"error"}),l(!1)}):u("Please fill all fields",{variant:"error"})},k=a=>{a.target.name==="name"?t({...p,name:a.target.label,id:a.target.value}):t({...p,[a.target.name]:a.target.value})},Q=a=>{const{target:{value:n}}=a;t({...p,stage:typeof n=="string"?n.split(","):n})},Z=a=>{t(n=>({...n,stage:n.stage.filter(r=>r!==a)}))},{name:W,gender:ee,availablity:ae,stage:z,limit:te}=p;return s(le,{children:[o?e(J,{disabled:f,onClick:m,children:e(re,{})}):e(A,{variant:"contained",color:"primary",onClick:m,className:b.btn,disabled:f,children:"Add Owner"}),s(ie,{open:D,onClose:c,children:[e(se,{children:"Add New Owner"}),s(oe,{sx:{display:"flex",flexDirection:"column",gap:3},children:[e(B,{sx:{pt:"0.4rem"},children:e(ce,{name:"name",value:W,onChange:(a,n)=>k({target:{name:"name",label:n.label,value:n.value}}),options:S.map(a=>({value:a.id,label:a.user})),isOptionEqualToValue:(a,n)=>a.label===n,placeholder:"Select Owner",renderInput:a=>e(V,{label:"Select Owner",helperText:"Please Select Owner",...a})})}),s(B,{children:[e(Y,{children:"Select Gender"}),s(j,{name:"gender",value:ee,onChange:k,placeholder:"Select Gender",label:"Select Gender",children:[e(C,{value:"",disabled:!0,children:"Select an Option"}),Object.entries(Se).map(([a,n])=>e(C,{value:a,children:n},a))]}),e(E,{className:b.text,id:"my-helper-text",children:"Please select your gender"})]}),s(B,{children:[e(Y,{children:"Select Availability"}),s(j,{name:"availablity",value:ae,onChange:k,placeholder:"Select Availablity",children:[e(C,{value:"",disabled:!0,children:"Select an Option"}),[{value:!0,label:"Yes"},{value:!1,label:"No"}].map(({value:a,label:n})=>e(C,{value:a,children:n},a))]}),e(E,{className:b.text,id:"my-helper-text",children:"Select Yes/No"})]}),s(B,{children:[e(Y,{children:"Select Stage"}),s(j,{name:"stage",label:"Select Stage",placeholder:"Select Stage",value:z,multiple:!0,onChange:Q,renderValue:a=>e(U,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:a.map(n=>e(de,{onMouseDown:r=>{r.stopPropagation()},label:q.find(r=>r.value===n).label,onDelete:()=>Z(n)},n))}),children:[e(C,{value:"",disabled:!0,children:"Select an Option"}),q.filter(({value:a})=>!z.includes(a)).map(({label:a,value:n})=>e(C,{value:n,children:a},n))]}),e(E,{className:b.text,id:"my-helper-text",children:"Stage select kariye jo aap owner ko assign karna chahate ho."})]}),e(V,{type:"number",id:"limit",name:"limit",label:"Interview Limit",placeholder:"Interview Limit",value:te,onChange:k,helperText:"Ek student kitne interviews le sakta hai."})]}),s(me,{children:[e(A,{variant:"outlined",color:"primary",onClick:c,children:"Cancel"}),e(A,{variant:"contained",color:"primary",onClick:o?x:h,className:b.btn,disabled:o&&!W,children:`${o?"Update":"Add"} Owner`})]})]})]})},Be="https://join.navgurukul.org/api/";function Te(g){const{scheduleOpen:o,setScheduleOpen:f}=g,y=[{name:"name",label:"Name",options:{filter:!1,sort:!1}},{name:"phone",label:"Phone No.",options:{filter:!1,sort:!1}},{name:"email",label:"Email",options:{filter:!1,sort:!1}},{name:"start_time",label:"Start Time",options:{filter:!1,sort:!1,customBodyRender:l=>T(l,"hh:mm").format("hh:mm A")}},{name:"end_time_expected",label:"Expected End Time",options:{filter:!1,sort:!1,customBodyRender:l=>T(l,"hh:mm").format("hh:mm A")}},{name:"on_date",label:"Date",options:{filter:!0,sort:!0,customBodyRender:l=>T(l).format("D MMM YYYY")}},{name:"owner",label:"Owner Name",options:{filter:!0,sort:!0}},{name:"topic_name",label:"Topic Name",options:{filter:!0,sort:!0}}],[d,b]=N.exports.useState([]),[u,S]=N.exports.useState(new Date),D=l=>{const p=T(l);if(!p.isValid())return;const t=p.format("YYYY-MM-DD");F.get(`${Be}/slot/interview/ondate/${t}`).then(({data:i})=>{const h=i.data.map(m=>{var c;return{...m,name:m.student.name,email:m.student.email,phone:m.contacts.mobile,owner:((c=m.user)==null?void 0:c.user_name)||""}});S(t),b(h)})};return N.exports.useEffect(()=>{D(u)},[]),e(ue,{open:o,onClose:()=>f(!1),sx:{height:"85%",marginTop:"1.4rem",width:"99%",mx:"1.2rem",overflow:"scroll"},children:s(pe,{sx:{py:"1.2rem",px:"0.8rem"},children:[e(he,{variant:"h3",textAlign:"center",fontWeight:"medium",children:"Interview Schedule"}),s(U,{sx:{display:"flex",flexDirection:"column",gap:2},children:[e(U,{sx:{display:"flex",justifyContent:"center"},children:e(ge,{dateAdapter:be,children:e(fe,{margin:"normal",format:"MM/dd/yyyy",value:u,onChange:l=>D(l),inputVariant:"outlined",renderInput:l=>e(V,{...l})})})}),e(K,{title:"Schedule",columns:y,data:d})]})]})})}const Ie=X(()=>({innerTable:{marginLeft:"3vw",marginRight:"3vw",width:"80vw",marginTop:"5",marginBottom:"5",[R.breakpoints.up("md")]:{margin:"auto",marginTop:5,marginBottom:5}},buttons:{display:"flex",gap:R.spacing(2),margin:R.spacing(2)}})),M={defaultValue:"#F0E5D8",EnglishInterview:"#FFC478",AlgebraInterview:"#EFB7B7",CultureFitInterview:"#75CFB8"},Ve=()=>{const g=Ie(),o=we(),{loggedInUser:f,privileges:y}=I(t=>t.auth),{ownerData:d}=I(t=>t.owners),{isFetching:b}=I(t=>t.ui),[u,S]=$.useState(!1),D=[{name:"id",label:"Edit",options:{filter:!1,sort:!1,customBodyRender:$.useCallback((t,i)=>{const h=(f==null?void 0:f.mail_id)||null,m=y.some(x=>x.privilege==="UpdateOwner")||i.rowData[1]===h,c=(y.some(x=>x.privilege==="DeleteOwner")||i.rowData[1]===h)&&i.rowData[4]===0;return s("div",{style:{display:"flex",margin:"10px",justifyContent:"space-between"},children:[e(H,{ownerId:t,isEdit:!0,disabled:!m,updateOwners:l}),e(J,{disabled:!c,onClick:()=>o(De({title:`Do you want to delete owner ${i.rowData[1].mail_id} ??`,actions:e(A,{onClick:()=>{p(t),o(Oe())},color:"primary",variant:"contained",children:"Confirm"})})),children:e(ve,{color:c?"error":"",style:{cursor:"pointer"}})})]})},[])}},{name:"user",label:"Name",options:{filter:!0,sort:!0,customBodyRender:t=>t.mail_id}},{name:"gender",label:"Gender",options:{filter:!0,sort:!0,customBodyRender:t=>t===1?"Female":t===2?"Male":t===3?"Transgender":"N/A"}},{name:"available",label:"Available",options:{filter:!0,sort:!1,customBodyRender:t=>t?"Yes":"No"}},{name:"pending_interview_count",label:"Pending Interviews",options:{filter:!1,sort:!0}},{name:"type",label:"Interview Types",options:{filter:!1,sort:!1,customBodyRender:t=>t.map(i=>M[i]?s("p",{style:{backgroundColor:M[i],textAlign:"center",borderRadius:"75px"},children:[" ",i," "]},i):s("p",{style:{backgroundColor:M.defaultValue,textAlign:"center",borderRadius:"75px"},children:[" ",i," "]},i))}},{name:"max_limit",label:"Assigned Interviews Limit",options:{filter:!1,sort:!0}}];N.exports.useEffect(()=>{o(Ce()),o(Ae())},[]);const l=(t,i)=>{if(i){const h=[...d],m=h.findIndex(x=>x.id===t.id),c={...h[m]};c.available=t.available,c.type=t.type,c.max_limit=t.max_limit,c.gender=t.gender,h[m]=c,o(G(h))}else o(G([t,...d]))},p=t=>{o(ke({ownerId:t}))};return e(ye,{mt:2,children:e(xe,{theme:R,children:s("div",{className:g.innerTable,children:[s("div",{className:g.buttons,children:[e(H,{disabled:!y.some(t=>t.privilege==="AddOwner"),updateOwners:l,ownerData:d}),e(A,{variant:"contained",color:"primary",onClick:()=>S(!0),className:g.btn,children:"Interview Schedule"})]}),e(Te,{setScheduleOpen:S,scheduleOpen:u}),e(K,{title:"Owners",columns:D,data:d,showLoader:b})]})})})};export{Ve as default};
