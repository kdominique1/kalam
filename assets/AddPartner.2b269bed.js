import{ba as H,ca as J,bh as K,bj as M,aI as P,b as Q,aT as t,bc as X,ce as ee,bb as h,bv as n,bt as f,aV as R,cZ as D,bs as x,c_ as F,c$ as T}from"./vendor.9dfca3cc.js";import{a as $}from"./vendor_axios.5abceb0c.js";import{u as te,a as q,C as g}from"./vendor_react_hook_form.90e3307f.js";import{c as W}from"./index.ad695817.js";import"./vendor_core_js_pure.26d1b0db.js";import"./vendor_react_epic_spinners.bbaea7d4.js";import"./vendor_mui_datatables.3afb61c8.js";import"./vendor_lodash.872a697f.js";import"./vendor_react_slick.b9cbcc15.js";import"./vendor_react_easy_edit.1ec3282f.js";import"./vendor_react_player.58c4554f.js";const S="https://join.navgurukul.org/api/",re=H(i=>({container:{display:"flex",flexWrap:"wrap",flexDirection:"column",maxWidth:400},root:{maxWidth:450,margin:"auto",marginTop:"20px"},addIcon:{position:"absolute",marginLeft:"60%",top:"9px"},text:{marginBottom:i.spacing(1)},btn:{marginTop:i.spacing(4)}})),he=({partnerId:i,closeDialog:j})=>{const m=re(),C=J(),{enqueueSnackbar:p}=K(),E=M(),w=()=>E(W(!0)),k=()=>E(W(!1)),[c,A]=P.useState({name:"",email:"",slug:"",notes:"",state:"",partnerEmail:"",partnerUsers:[{email:""}],districts:[""]}),{handleSubmit:z,formState:{errors:s},control:d,reset:N}=te(),{fields:V,append:L,remove:Z}=q({control:d,name:"partnerUsers"}),{fields:B,append:I,remove:_}=q({control:d,name:"districts"});Q.exports.useEffect(()=>{if(i){const a=`${S}partners/${i}`;$.get(a).then(e=>{const{data:r}=e.data;A(l=>({...l,name:r.name||"",email:r.email||"",slug:r.slug||"",notes:r.notes||"",state:r.state||"",partnerUsers:r.partnerUser||[{email:""}],districts:r.districts||[""]})),N({name:r.name||"",email:r.email||"",slug:r.slug||"",notes:r.notes||"",state:r.state||"",partnerUsers:r.partnerUser||[{email:""}],districts:r.districts||[""]})})}else N({...c,partnerUsers:[""],districts:[""]})},[]);const Y=async a=>{const{name:e,email:r,notes:l,slug:y,partnerUsers:v,districts:b}=a,U=b.filter(u=>u.length>0);try{w();const u=` ${S}partners`,o=await $.post(u,{name:e,email:r,notes:l,slug:y,partner_user:v,districts:U},{headers:{Authorization:`Bearer ${localStorage.getItem("jwt")}`}});o.data.error?p(o.data.message,{variant:"error"}):(p("Partner details added Successfull!",{variant:"success"}),k(),C("/partners"))}catch{p("All fields are mandatory Or Slug should be unique",{variant:"error"}),k()}},G=a=>{const{name:e,email:r,notes:l,partnerUsers:y,districts:v,state:b,slug:U}=a,u=v.filter(o=>o.length>0);$.put(`${S}partners/${i}`,{name:e,email:r||null,notes:l,slug:U,state:b||null,partner_user:y||null,districts:u.length>0?u:null}).then(o=>{o.data.error?p(`Something went wrong, ${o.data.message}`,{variant:"error"}):(p("Partner details Successfull edit",{variant:"success"}),k(),C("/partners"))}).catch(o=>{p(`Something went wrong, ${o}`,{variant:"error"})})},O=a=>{A(e=>({...e,...a})),i?G(a):Y(a)};return t(X,{component:ee,maxWidth:"sm",className:m.root,children:h(n,{container:!0,spacing:2,sx:{p:".4rem"},children:[h(n,{item:!0,xs:12,children:[t(g,{control:d,defaultValue:c.name||"",name:"name",rules:{required:!0,maxLength:40},render:({field:{ref:a,...e}})=>t(f,{variant:"outlined",fullWidth:!0,id:"name",inputRef:a,className:m.spacing,label:"Partner Name",placeholder:"Partner Name",autoComplete:"off",type:"text",error:!!s.name,helperText:s.name&&s.name.type==="maxLength"?"Length should be under 40 characters":"Partner ka Name Enter karein.",...e})}),t(g,{control:d,defaultValue:c.email||"",name:"email",rules:{required:!0,pattern:/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/},render:({field:{ref:a,...e}})=>t(f,{variant:"outlined",fullWidth:!0,id:"email",inputRef:a,className:m.spacing,label:"Email",placeholder:"Email",autoComplete:"off",type:"email",style:{marginTop:"1rem"},error:!!s.email,helperText:s.email?s.email.type==="pattern"?"Please enter a valid email address":"Email ka Address Enter karein.":"Partner ka Email Enter karein.",...e})}),t(g,{control:d,defaultValue:c.notes||"",name:"notes",rules:{required:!0},render:({field:{ref:a,...e}})=>t(f,{variant:"outlined",fullWidth:!0,id:"notes",inputRef:a,className:m.spacing,label:"Notes",placeholder:"Notes",autoComplete:"off",type:"text",style:{marginTop:"1rem"},error:!!s.notes,helperText:s.notes&&s.notes.type==="required"?"Please enter notes":"Partner ki thodi details add karein.",...e})}),t(g,{control:d,defaultValue:c.slug||"",name:"slug",rules:{required:!0},render:({field:{ref:a,...e}})=>t(f,{variant:"outlined",fullWidth:!0,id:"slug",inputRef:a,className:m.spacing,label:"Slug",placeholder:"Slug",autoComplete:"off",type:"text",style:{marginTop:"1rem"},error:!!s.slug,helperText:s.slug&&s.slug.type==="required"?"Please enter slug":"Partner ke student ko online test dene ke liye Slug add karo.",...e})})]}),V.map((a,e)=>{var r;return h(P.Fragment,{children:[t(n,{item:!0,xs:9,children:t(g,{control:d,defaultValue:((r=c.partnerUsers[e])==null?void 0:r.email)||"",name:`partnerUsers[${e}].email`,rules:{required:!0,pattern:/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/},render:({field:{ref:l,...y}})=>t(f,{variant:"outlined",fullWidth:!0,id:`partnerUsers[${e}]`,name:`partnerUsers[${e}]`,inputRef:l,label:`User Email ${e+1}`,placeholder:`User Email ${e+1}`,autoComplete:"off",type:"email",error:!!s.partnerUsers&&!!s.partnerUsers[e],helperText:s.name?"Required Field":`Enter Partner Email ${e+1}`,...y})})}),t(n,{item:!0,xs:2,sx:{display:"flex",alignItems:"center",justifyContent:"left"},children:t(R,{color:"primary",size:"large",onClick:()=>Z(e),style:{borderSpacing:"-1"},children:t(D,{})})})]},a.id)}),t(n,{item:!0,xs:12,sx:{mY:"0.2rem"},children:h(x,{variant:"outlined",color:"primary",onClick:()=>L(),children:[t(F,{style:{display:"flex",alignItems:"center",marginRight:"1vh"},children:t(T,{})}),"Add Another Email"]})}),B.map((a,e)=>h(P.Fragment,{children:[t(n,{item:!0,xs:9,children:t(g,{control:d,defaultValue:c.districts[e]||"",name:`districts[${e}]`,rules:{required:!0},render:({field:{ref:r,...l}})=>t(f,{variant:"outlined",fullWidth:!0,id:`districts[${e}]`,inputRef:r,label:`District ${e+1}`,placeholder:`District ${e+1}`,autoComplete:"off",type:"email",error:!!s.partnerUsers&&!!s.partnerUsers[e],helperText:s.name?"Required Field":`Enter District ${e+1}`,...l})})}),t(n,{item:!0,xs:2,sx:{display:"flex",alignItems:"center",justifyContent:"left"},children:t(R,{color:"primary",size:"large",onClick:()=>_(e),style:{borderSpacing:"-1"},children:t(D,{})})})]},a.id)),t(n,{item:!0,xs:12,sx:{mY:"0.2rem"},children:h(x,{variant:"outlined",color:"primary",onClick:()=>I(),children:[t(F,{style:{display:"flex",alignItems:"center",marginRight:"1vh"},children:t(T,{})}),"Add Another District"]})}),t(n,{item:!0,xs:i?6:12,children:t(x,{fullWidth:!0,variant:"contained",color:"primary",onClick:z(O),className:m.btn,children:i?"Update Partner":"Add Partner"})}),i?t(n,{item:!0,xs:6,children:t(x,{fullWidth:!0,variant:"outlined",color:"primary",onClick:j,className:m.btn,children:"Cancel"})}):null]})})};export{he as default};
